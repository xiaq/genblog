<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
	{{ if .IsHomepage }}
		<link rel="alternate" type="application/atom+xml" href="{{ .RootURL }}/feed.atom">
	{{ end }}

    <title>
        {{ .BlogTitle }} » 
        {{ if .IsCategory }}
            {{ index .CategoryMap .Category }}
        {{ else }}
            {{ .Title }}
        {{ end }}
    </title>
    <style> {{ .CSS }} </style>
</head>
<body>
    <div class="card" id="header">
        <a href="{{ .Root }}/index.html" class="nav-link">
            {{ .BlogTitle }}
        </a>
    </div>
    <div class="card" id="content">
        {{ template "content" . }}
    </div>
</body>
</html>

{{ define "category-list" }}
	{{ $isCat := .IsCategory }}
	{{ $cat := .Category }}
	{{ $root := .Root }}
	<ul class="category-list">
		{{ range $info := .Categories }}
			<li><a href="{{ $root }}/{{ $info.Name }}/index.html"
				   class="nav-link {{ if and $isCat (eq $cat $info.Name) }}current{{ end }}">
				{{ $info.Title }}
			</a></li>
		{{ end }}
	</ul>
{{ end }}

{{ define "article-list" }}
	<ul class="article-list">
		{{ $root := .Root }}
        {{ $isCat := .IsCategory }}
        {{ $catMap := .CategoryMap }}
		{{ range $info := .Articles }}
			<li>
				<a href="{{ $root }}/{{ $info.Category }}/{{ $info.Name }}.html" class="nav-link">{{ $info.Title }}</a> 
				<span class="article-meta">
                {{ if not $isCat }}
                    {{ index $catMap $info.Category }} ·
                {{ end }}
                {{ $info.Timestamp }}
                </span>
                <div class="clear"></div>
			</li>
		{{ end }}
	</ul>
{{ end }}

{{ define "article-content" }}
	<article class="article">
		<h1>{{ .Title }}</h1>
        <div class="clear"></div>
        <span class="article-meta">
            <a href="{{ .Root }}/{{ .Category }}/index.html" class="nav-link">
                {{ index .CategoryMap .Category }}
            </a>
            ·
            {{ .Timestamp }}</span>
        <div class="clear"></div>
		{{ .Content }}
	<div class="clear"></div>
	</article>
	<hr>
	{{ if .IsHomepage }}
		<div class="recent">
			{{ .L10N.RecentTitle }}
			{{ template "article-list" . }}
		</div>
		<hr>
	{{ end }}
	<div class="article-category-list">
		{{ .L10N.CategoryListTitle }}
		{{ template "category-list" . }}
	</div>
	<div class="clear"></div>
{{ end }}

{{ define "category-content" }}
	{{ template "category-list" . }}
	{{ template "article-list" . }}
{{ end }}
